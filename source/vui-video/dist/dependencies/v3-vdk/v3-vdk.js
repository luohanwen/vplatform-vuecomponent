!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("vPlatform-resource-29ee768144ce68cbddff76c0a39b52c9",[],r):"object"==typeof exports?exports["vPlatform-resource-29ee768144ce68cbddff76c0a39b52c9"]=r():e["vPlatform-resource-29ee768144ce68cbddff76c0a39b52c9"]=r()}("undefined"!=typeof self?self:this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var t={};return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s="JkW7")}({"2KSk":function(e,r,t){"use strict";function n(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()}function o(e){if(e&&e.length>0)for(var r=0,t=e.length;r<t;r++){var n=e[r];!0===n._metadata_.isCurrent&&(n._metadata_={isCurrent:!1,isSelected:!1,dsName:n._metadata_.dsName})}return n}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=t("g9f8"),c=function(e){return e&&e.__esModule?e:{default:e}}(i);r.default={setCurrentRecord:function(e){if(!(!e|!e.record)){var r=e.vueObj;if(r){var t=e.record;r.markCurrent(t)}else if(e.entityRecords&&e.entityRecords.length>0){var n=e.record.id;if(!n)throw new Error("无法读取记录的id属性，不能设置为当前行");if(e.record._metadata_&&e.record._metadata_.isCurrent)return;for(var o=e.entityRecords,a=0,i=o.length;a<i;a++){var t=o[a];if(void 0==t._metadata_)throw new Error("实体记录存在非源数据的记录，请检查.");n==t.id?(t._metadata_={isCurrent:!0,isSelected:!0,dsName:t._metadata_.dsName},o.current=t):!0===t._metadata_.isCurrent&&(t._metadata_={isCurrent:!1,isSelected:!1,dsName:t._metadata_.dsName})}}}},getSelectedRecord:function(e){var r=[];if("object"==(void 0===e?"undefined":a(e))){var t=e.vueObj,n=e.records;if(t)return t.getSelectedRecords();if(t&&n&&n.length>0){var o=e.records[0]._metadata_.dsName,i=c.default.getSelectedRecords(t,o);if(i&&i.length>0){for(var d=[],u=0,l=i.length;u<l;u++)d.push(i[u].id);for(var u=0,l=n.length;u<l;u++){var _=n[u];-1!=d.indexOf(_.id)&&r.push(_)}}}else if(e.length>0)for(var u=0,s=e.length;u<s;u++){var _=e[u],f=_._metadata_;f&&f.isSelected&&r.push(_)}}return r},getCurrentRecord:function(e){if("object"==(void 0===e?"undefined":a(e))){var r=e.vueObj,t=e.records;if(r)return r.getCurrentRecord();if(r&&t&&t.length>0){var n=e.records[0],o=n._metadata_.dsName,i=c.default.getCurrentRecord(r,o);if(i)for(var d=0,u=t.length;d<u;d++){var n=t[d];if(n.id==i.id)return n}}else if(e.length>0)for(var d=0,l=e.length;d<l;d++){var i=e[d],_=i._metadata_;if(_&&!0===_.isCurrent)return e.current=i,i}}return null},setSelectRecords:function(e){if("object"==(void 0===e?"undefined":a(e))&&e.records&&e.records.length>0){var r=e.vueObj,t=!0===e.isSelect,n=e.records;if(r)r.markSelected(n);else for(var o=0,i=n.length;o<i;o++){var c=n[o],d=c._metadata_;d&&1!=d.isSelected&&(c._metadata_.isSelected=t)}}},isSelected:function(e){var r=e.vueObj;if(r&&e.record)return r.isSelected(e.record);var t=e._metadata_;return t&&t.isSelected},isCurrent:function(e){var r=e.vueObj;if(r&&e.record)return r.isCurrent(e.record);var t=e._metadata_;return t&&t.isCurrent},insertRecords:function(e){if(e&&e.records){for(var r=e.records,t={},a=0,i=r.length;a<i;a++){var c=r[a];c.id||(c.id=n());var d=a==i-1;c._metadata_={isCurrent:d,isSelected:d},d&&(t=c)}var u=e.entityRecords;u&&u.length>0&&o(u),u.push.apply(u,r),u.current=t}},deleteRecords:function(e){if(e&&e.records&&e.records.length>0&&e.entityRecords&&e.entityRecords.length>0){for(var r=null,t=[],n=e.records,a=0,i=n.length;a<i;a++){var c=n[a].id;!0===n[a]._metadata_.isCurrent&&(r=c),t.push(c)}for(var d=e.entityRecords,a=0;a<d.length;a++){var u=d[a].id;-1!=t.indexOf(u)&&(d.splice(a,1),a--)}null!=r&&(d.length>0?(o(d),d[0]._metadata_={isCurrent:!0,isSelected:!0,dsName:d[0]._metadata_.dsName},d.current=d[0]):d.current=[])}},updateRecords:function(e){if(e&&e.records&&e.records.length>0){for(var r=e.records,t={},n=0,o=r.length;n<o;n++){var a=r[n];t[a.id]=a}for(var i=e.entityRecords,n=0,o=i.length;n<o;n++){var a=i[n];if(t[a.id]){var c=t[a.id];for(var d in c)"_metadata_"!=d&&c.hasOwnProperty(d)&&(a[d]=c[d])}}}},clearRecordDatas:function(e){if(void 0!=e&&e.length>0)for(var r=0,t=e.length;r<t;r++){var n=e[r];if(n)for(var o in n)n.hasOwnProperty(o)&&"id"!=o&&"_metadata_"!=o&&(n[o]=null)}},markMultipleDs:function(e){var r=e.vueObj;e.records;r&&r.markDatasourceMultipleSelect()}}},HaNs:function(e,r,t){"use strict";function n(){return d._$V3GlobalDataStore$_||(d._$V3GlobalDataStore$_={}),d._$V3GlobalDataStore$_}function o(e,r){var t=n();if(t.hasOwnProperty(e))throw new Error("全局数据已存在key: "+e+", 请检查.");t[e]=r}function a(e){return n()[e]}function i(e,r){n()[e]=r}function c(e){return n().hasOwnProperty(e)}Object.defineProperty(r,"__esModule",{value:!0});var d=window;r.default={put:o,get:a,meger:i,exists:c,datas:n()}},JkW7:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=t("2KSk"),a=n(o),i=t("dThJ"),c=n(i),d=t("HaNs"),u=n(d),l=t("fTHo"),_=n(l),s=t("vn7Q"),f=n(s),S=t("g9f8"),E=n(S),v=t("Vcb0"),O=n(v);r.default={ds:a.default,win:c.default,GLOBAL:u.default,webapi:_.default,vue:f.default,v3platform:E.default,res:O.default}},RYcG:function(e,r){e.exports={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGSYS:12,SSL_OP_ALL:2147486719,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:32,SSL_OP_MICROSOFT_SESS_ID_BUG:1,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:536870912,SSL_OP_NETSCAPE_CHALLENGE_BUG:2,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:1073741824,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:8,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:16777216,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_SINGLE_DH_USE:1048576,SSL_OP_SINGLE_ECDH_USE:524288,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:128,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:512,SSL_OP_TLS_D5_BUG:256,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_ECDH:16,ENGINE_METHOD_ECDSA:32,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_STORE:256,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_UDP_REUSEADDR:4}},Vcb0:function(e,r,t){"use strict";function n(e,r,t){var n=t,a=t.split("/"),i=a[a.length-1];if(void 0!==window._$v3platform_runtime_env&&window._$v3platform_runtime_env)n="itop/common/extension/custom/"+r+"/"+e+"/"+i;else if("undefined"!=typeof GlobalVariables){var c=GlobalVariables.getServerUrl();n=c+"/itop/common/extension/custom/"+r+"/"+e+"/"+i}else void 0!==window._$v3platform_preview_env&&window._$v3platform_preview_env&&(n=o+"/"+e+"/"+t.substring(t.indexOf("/")));return n}Object.defineProperty(r,"__esModule",{value:!0});var o="dependencies";r.default={getWidgetResPath:n}},dThJ:function(e,r,t){"use strict";function n(){return!(!window.VMetrix||!window.VMetrix.loadBundles)}function o(e){if(!e)return void console.warn("参数无效，已忽略.");if(!n())throw new Error("未运行在V3服务内，无法执行操作.");var r,t=e.componentCode,o=e.windowCode,a=e.params?e.params:{},i={variable:a},c=(e.success,e.fail,e.title);switch(e.type){case"currentContainer":i.variable.formulaOpenMode="locationHref",r=function(e){e.browser.redirectModule({componentCode:e.componentCode,windowCode:e.windowCode,params:{inputParam:e.windowInputParams}})};break;case"currentWindow":r=function(e){e.browser.redirectLocation({componentCode:e.componentCode,windowCode:e.windowCode,title:e.title,inputParam:e.windowInputParams})};break;case"newWindow":i.variable.formulaOpenMode="dialog",r=function(e){e.browser.callBrowserWindow({componentCode:e.componentCode,windowCode:e.windowCode,title:e.title,inputParam:e.windowInputParams,isBlock:!1,winName:"_blank"})};break;default:throw new Error("不支持这种打开方式: "+e.type)}var d=window.VMetrix,u=d.sandbox.create({extensions:["vjs.framework.extension.platform.services.browser"]});u.active().done(function(){var e=u.getService("vjs.framework.extension.platform.services.browser.Browser");e&&"function"==typeof r&&r({componentCode:t,windowCode:o,title:c,windowInputParams:i,browser:e})})}Object.defineProperty(r,"__esModule",{value:!0}),r.default={render:o,isRunInV3Service:n}},fTHo:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return null===e||void 0===e};r.default={exec:function(e){if(n(e.apiCode))throw Error("调用后台webapi时，请传递apiCode参数！");if(n(e.componentCode))throw Error("调用后台webapi时，请传递componentCode参数！");jQuery.post("webapi/"+e.componentCode+"/"+e.apiCode,Object.assign({_:Math.random()},e.params||{}),function(r,t,n){r.success&&e.success?e.success(r.data):"-1"===r.errorCode||e.fail&&e.fail(r)},"json")}}},g9f8:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,r){var t=r.$root;if(t&&t._$v3platform){var n=t._$v3platform(),o=n.datasource[e];if(o){var a=Array.prototype.slice.call(arguments,2);return o.apply(t,a)}}},o=function(e){var r=e.vueObj;return"function"==typeof r.$root._$registerDsEvent&&(r.$root._$registerDsEvent(function(e){return function(){var r=e.$attrs;if(r&&r.___ds___&&r.___field___){var t=r.___ds___,n=r.___field___;n=-1!=n.indexOf(",")?n.split(","):[r.___field___];var o=e.$root._$getDatasource(t);null!=o&&o.on({eventName:o.Events.UPDATE,handler:function(r){var t=!1,o=null,a=null,i=r.resultSet.datas;if(i&&i.length>0)for(var c=0,d=i.length;c<d;c++)for(var u=i[c],l=u.getChangedData(),_=0,s=n.length;_<s;_++)l.hasOwnProperty(n[_])&&(a=l[n[_]],t=!0);if((i=r.oldResultSet.datas)&&i.length>0)for(var c=0,d=i.length;c<d;c++)for(var u=i[c],_=0,s=n.length;_<s;_++)o=u[n[_]];t&&e.$nextTick(function(){e.$emit("on-change",a,o)})}})}}}(r)),!0)},a=function(e,r){if(!e.$root._getComponentCode)return r;var t=e.$root._getComponentCode(),n="itop/resources/"+t+"_"+r;return window.GlobalVariables?GlobalVariables.getServerUrl()+"/"+n:n},i=function(e){if(void 0!=e&&null!=e&&e&&""!=e){var r="module-operation!executeOperation?operation=FileDown&token=%7B%22data%22%3A%7B%22dataId%22%3A%22"+e+"%22%2C%22ImageObj%22%3A%22"+e+"%22%7D%7D";return window.GlobalVariables?GlobalVariables.getServerUrl()+"/"+r:r}};r.default={synCurrentRecordToDs:function(e,r,t,o){return n("synCurrentRecordToDs",e,r,t,o)},synCurrentIdToDs:function(e,r,t,o){return n("synCurrentIdToDs",e,r,t,o)},synSelectRecordToDs:function(e,r,t,o){return n("synSelectRecordToDs",e,r,t,o)},registerCurrentHandler:function(e,r){return n("registerCurrentHandler",e,r)},registerSelectHandler:function(e,r){return n("registerSelectHandler",e,r)},markDsMultipleSelect:function(e,r){return n("markDsMultipleSelect",e,r)},getVuiVersion:function(e){return e&&e.$root?e.$root.vui_version:null},getCurrentRecord:function(e,r){return n("getCurrentRecord",e,r)},getSelectedRecords:function(e,r){return n("getSelectedRecords",e,r)},isSelected:function(e,r,t){return n("isSelectedRecord",e,r,t)},isCurrent:function(e,r,t){return n("isCurrentRecord",e,r,t)},markMultipleDs:function(e,r){return n("setDsMultiSelect",e,r)},registerDsUpdateEvent:o,getSrcPathFromRes:a,getSrcPathFromId2url:i,genUUID:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()},isRunInV3Service:function(e){var r=e;return!(!window.VMetrix||!window.VMetrix.loadBundles)||!(!r||!r.$root||"function"!=typeof r.$root._$getDatasource)},v3Log:function(e,r){if(window&&window.console)switch(e){case"warn":window.console.warn(r);break;case"error":window.console.error(r);break;default:window.console.log(r)}}}},vn7Q:function(e,r,t){"use strict";function n(e){return g(e,"datasource")}function o(e,r){var t=a(r);for(var n in e.prop)t.prop[n]=e.prop[n];for(var o in e.event)t.event[o]=e.event[o];return t}function a(e){return{datasource:{prop:{required:!0,default:[]},event:{load:!0,change:!0,currentChange:!0,selectionChange:!0}},record:{prop:{required:!0,default:{}},event:{load:!0,change:!0}},cell:{prop:{required:!0,default:{}},event:{load:!0,change:!0}}}[e]}function i(e,r){var t={datasource:["isCurrent","isSelected","markCurrent","markSelected","markUnSelect","getDatasourceName","getCurrentRecord","getSelectedRecords","v3PlatformFireEvent","markDatasourceMultipleSelect","registerColumnChangeHandler"]},n=e.prop.name,o={},a=t[r];if(a)for(var i=0,d=a.length;i<d;i++){var u=a[i],l=c(u,n);o[u]=l}return o}function c(e,r){var t=function(e,t,n){if(!(t instanceof Array))throw new Error('标记选中/不选中的数据必须为数组类型，只标记一行数据请用"[]"将数据包装成数组。');var o=t.length;if(o>0)if(a(e)){var i=null;if(!t[0]._metadata_)throw new Error("无法获取实体编码");i=t[0]._metadata_.dsName;for(var c=0;c<o;c++){var d=t[c];if(!d)throw new Error("行记录不存在，无法设置为选中状态");h.default.synSelectRecordToDs(e,i,d,n)}}else{var u=e.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r],l=u.selectedRecords;if(!0===n){var d=t[0];if(!0===e.isMultipleSel){for(var _=!1,c=0,s=t.length;c<s;c++){var d=t[c];-1==l.indexOf(d)&&(l.push(d),_=!0)}_&&e.v3PlatformFireEvent(e,u.selectionChange,[u.selectedRecords])}else t.length>1&&h.default.v3Log("warn","非多选数据源，不支持设置多个选中，已选第一条作为选中记录"),d!=u.currentRecord&&(u.currentRecord=d,u.selectedRecords=[d],e.v3PlatformFireEvent(e,u.currentChange,[u.currentRecord]),e.v3PlatformFireEvent(e,u.selectionChange,[u.selectedRecords]))}else if(!0===e.isMultipleSel){for(var _=!1,c=0,s=t.length;c<s;c++){var d=t[c],f=l.indexOf(d);-1!=f&&(_=!0,l.splice(f,1))}_&&e.v3PlatformFireEvent(e,u.selectionChange,[u.selectedRecords])}else h.default.v3Log("error","非多选数据源, 不支持取消选中")}},n=function(){throw new Error("无法获取实体编码")},o=function(e){return e.$options.propsData[r]._metadata_?e.$options.propsData[r]._metadata_.dsName:e[r]._metadata_?e[r]._metadata_.dsName:e[r]&&e[r][0]&&e[r][0]._metadata_?e[r][0]._metadata_.dsName:null},a=function(e){return h.default.isRunInV3Service(e)};return{registerColumnChangeHandler:function(e,r){var t=this;t[I]?t[I][e]=r:(t[I]={},t[I][e]=r)},getDatasourceName:function(){var e=this;return a(this)?o(e):(window.console&&window.console.warn("本地数据暂不支持获取数据源名称"),null)},getCurrentRecord:function(){var e=this;return a(this)?h.default.getCurrentRecord(e,o(e)):e.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r].currentRecord},getSelectedRecords:function(){var e=this;return a(this)?h.default.getSelectedRecords(e,o(e)):e.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r].selectedRecords},markDatasourceMultipleSelect:function(){var e=this;if(a(e)){var t=o(e);h.default.markMultipleDs(e,t)}else{this.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r].isMultipleSel=!0}},isCurrent:function(e){var t=this;if("string"==typeof e){if(!a(this))return window.console&&window.console.warn("本地数据不支持根据id判断是否当前行"),!1;var i=o(t);if(i){var c=h.default.getCurrentRecord(t,i),d=c.id;if(d)return d===e;throw new Error("无法读取当前行记录的id属性，无法校验")}n()}else{if("object"!==(void 0===e?"undefined":p(e)))throw new Error("不支持处理该类型数据，传入数据必须是行记录的id(string)或行记录(object)");if(!a(this)){return e==this.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r].currentRecord}var i=e._metadata_.dsName;if(i)return h.default.isCurrent(t,i,e);n()}},isSelected:function(e){var t=this;if("string"==typeof e){if(!a(this))return window.console&&window.console.warn("本地数据不支持根据id判断是否选中行"),!1;var i=o(t);if(i){var c=h.default.getSelectedRecords(t,i);if(c){for(var d=0,u=c.length;d<u;d++){if(c[d].id===e)return!0}return!1}throw new Error("无法获取选中行记录")}n()}else{if("object"!==(void 0===e?"undefined":p(e)))throw new Error("不支持处理该类型数据，传入数据必须是行记录的id(string)或行记录(object)");if(a(this)){var i=e._metadata_.dsName;if(i)return h.default.isSelected(t,i,e);n()}else{if(-1!=this.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r].selectedRecords.indexOf(e))return!0}}},markCurrent:function(e){var t=this,n=o(t);if("string"==typeof e){if(!a(this))return window.console&&window.console.warn("本地数据不支持使用id设置选中行"),!1;var i=t[r];if(!i)throw new Error("无法获取实体");for(var c=null,d=0,u=i.length;d<u;d++){var l=i[d];if(l.id===e){c=l;break}}if(!c)throw new Error("无法根据ID获取行记录");h.default.synCurrentRecordToDs(t,n,c)}else{if("object"!==(void 0===e?"undefined":p(e)))throw new Error("不支持处理该类型数据，传入数据必须是行记录的id(string)或行记录(object)");if(a(this))null==n&&e._metadata_&&(n=e._metadata_.dsName),h.default.synCurrentRecordToDs(t,n,e);else{var _=this.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r];_.currentRecord=e,this.v3PlatformFireEvent(this,_.currentChange,[_.currentRecord]),!1===_.isMultipleSel&&(_.selectedRecords=[e],this.v3PlatformFireEvent(this,_.selectedChange,[_.selectedRecords]))}}},markSelected:function(e){t(this,e,!0)},markUnSelect:function(e){t(this,e,!1)},v3PlatformFireEvent:function(e,r,t){for(var n=0,o=r.length;n<o;n++){var a=r[n];"function"==typeof a&&a.apply(e,t)}}}[e]}function d(e,r,t){var n=e.$watch("V3_PLATFORM_ENTITY_DATAS_INFO_IDEN."+r+".datas."+t,function(e,r){return function(t){var n=e.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r],o=n.change;if(o&&o.length>0)for(var a=0,i=o.length;a<i;a++){var c=o[a];"function"==typeof c&&c.apply(e,[t])}}}(e,r),{deep:!0,sync:!0});e.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r].destroys[t]=n}function u(e,r,t){var n=t.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN;if(!n.hasOwnProperty(r)){var o=(h.default.genUUID(),{datas:{},destroys:{},load:[],change:[]});n[r]=o;var a=(o.datas,t[r]);if(e)for(var i=0,c=e.length;i<c;i++){var d=e[i],u=d.eventType;o.hasOwnProperty(u)&&o[u].push(d.handler)}a&&s(t,o.load,[a]),t.$watch(r,function(e,n){var o=t.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r].change;if(o&&o.length>0)for(var a=0,i=o.length;a<i;a++){var c=o[a];"function"==typeof c&&c.apply(t,[e,n])}})}}function l(e,r,t){var n=t.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN;if(!n.hasOwnProperty(r)){var o=(h.default.genUUID(),{datas:{},destroys:{},load:[],change:[]});n[r]=o;var a=o.datas,i=t[r];if(e)for(var c=0,u=e.length;c<u;c++){var l=e[c],_=l.eventType;o.hasOwnProperty(_)&&o[_].push(l.handler)}if(i){var f=h.default.genUUID();a[f]=i,d(t,r,f),s(t,o.load,i)}}}function _(e,r,t){var n=t.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN;if(!n.hasOwnProperty(r)){var o=(h.default.genUUID(),{datas:{},destroys:{},currentRecord:null,currentRecordDestory:null,selectedRecords:[],selectedRecordsDestory:null,isMultipleSel:!1,load:[],change:[],currentChange:[],selectionChange:[]});n[r]=o;var a=o.datas,i=t[r];if(e)for(var c=0,u=e.length;c<u;c++){var l=e[c],_=l.eventType;o.hasOwnProperty(_)&&o[_].push(l.handler)}if(i&&i.length>0){o.currentRecord=i[0],o.selectedRecords.push(i[0]);for(var c=0;c<i.length;c++){var f=h.default.genUUID(),S=i[c];a[f]=S,d(t,r,f)}s(t,o.load,i)}t.$watch(r,function(e){try{var n=this.V3_PLATFORM_ENTITY_DATAS_INFO_IDEN[r],o=[],a=n.datas;for(var c in a)o.push(a[c]);var u=[],l=[],_=n.selectedRecords;if(e&&e.length>0)for(var f=0,S=e.length;f<S;f++){var E=e[f];-1==o.indexOf(E)&&u.push(E)}for(var f=0,S=o.length;f<S;f++){var E=o[f];-1==e.indexOf(E)&&l.push(E)}var v=!1;if(l.length>0)for(var O=n.destroys,f=0,S=l.length;f<S;f++){var E=l[f];n.currentRecord===E&&!0;var p=_.indexOf(E);-1!=p&&(_.splice(p,1),v=!0);for(var N in a)if(E===a[N]){var I=O[N];try{"function"==typeof I&&I(),delete a[N];break}catch(e){}}}if(u.length>0){!0;for(var f=0,S=u.length;f<S;f++){var E=u[f],N=h.default.genUUID();a[N]=E,d(t,r,N)}}if(e.length>0){var T=e[e.length-1];n.currentRecord=T,!1===n.isMultipleSel&&-1==n.selectedRecords.indexOf(T)&&(v=!0,n.selectedRecords.push(T)),u.length>0?u.length>1||l.length>0?s(t,n.load,i):1==u.length&&(s(this,n.currentChange,[n.currentRecord]),v&&s(this,n.selectionChange,[n.selectedRecords])):l.length>0&&(s(this,n.currentChange,[n.currentRecord]),s(this,n.selectionChange,[n.selectedRecords]))}}catch(e){window&&window.console&&window.console.error("处理数据错误."+e)}finally{this._$V3PlatformDataHandlerIden=!1}},{deep:!1,sync:!0})}}function s(e,r,t){for(var n=0,o=r.length;n<o;n++){var a=r[n];"function"==typeof a&&a.apply(e,t)}}function f(e,r){var t=P;return function(){var n=this,o=S(e,n,r);if(h.default.isRunInV3Service(n))o.forEach(function(e,r){e.vueObj=n,t(e)});else{var a=e.prop.name;switch(r){case"record":l(o,a,n);break;case"cell":u(o,a,n);break;default:_(o,a,n)}}}}function S(e,r,t){var n=e.event,o=e.prop.name,a=[];if(n)for(var i in n)if(n.hasOwnProperty(i)){var c=E(n[i],i,r,t);c&&(c.controlType=t,c.dsName=o,a.push(c))}if("datasource"===t){var d={eventType:"change",controlType:t,dsName:o,name:"on-cell-change",handler:function(e,t){m(e,t,r)}};a.push(d)}return a}function E(e,r,t,n){var o={load:{name:"on-load",handler:function(){t.$emit("on-load")}},change:{name:"on-change",handler:function(){t.$emit("on-change")}},currentChange:{name:"on-current-change",handler:function(){t.$emit("on-current-change")}},selectionChange:{name:"on-selection-change",handler:function(){t.$emit("on-selection-change")}}},a={datasource:["load","change","currentChange","selectionChange"],record:["load","change"],cell:["load","change"]},i=null;if(null!=e&&o[r]&&a[n]&&-1!=a[n].indexOf(r)){var c=o[r],d=c.handler;if("boolean"==typeof e)!0===e&&(i={eventType:r,eventName:c.name,vueObj:t,handler:d});else if("object"===(void 0===e?"undefined":p(e))){var u=e.name;i={eventType:r,vueObj:t,eventName:c.name},u&&(d=function(){t.$emit(u)},i.eventName=u),i.handler="function"!=typeof e.handler?d:function(){e.handler.apply(t,arguments)}}}return i}function v(e,r){var t={datasource:{type:Array,v3PropType:"datasource",default:[]},record:{type:Object,v3PropType:"record",default:{}},cell:{type:[String,Number,Boolean],v3PropType:"cell",default:null}},n=e.name,o=t[r],a=e.default?e.default:o.default,i={};return i[n]={type:o.type,v3PropType:r,required:!0===e.required,default:function(e){return function(){return e}}(a),validator:"function"==typeof e.validator?e.validator:null},i}function O(e,r){return"cell"==r||!!(e&&e.prop&&e.prop.name)}Object.defineProperty(r,"__esModule",{value:!0});var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N=t("g9f8"),h=function(e){return e&&e.__esModule?e:{default:e}}(N),I=(t("RYcG"),"___$ColumnChangeHandler___"),T=function(e){return g(e,"record")},R=function(e){e?e.prop?e.prop.name="value":e.prop={name:"value"}:e={prop:{name:"value"}};var r=g(e,"cell");return r.watch={value:function(e,r){this.$emit("input",e)}},r},g=function(e,r){var t={};if(O(e,r)){e=o(e,r);var n=v(e.prop,r),a=f(e,r),c=i(e,r);t={props:n,created:a,data:function(){return{V3_PLATFORM_ENTITY_DATAS_INFO_IDEN:{}}},methods:c}}return t},m=function(e,r,t){var n=t[I],o=e;if(o&&o.length>0&&n)for(var a=0,i=o.length;a<i;a++)!function(e,r){var t=o[e],a=t,i=Object.keys(a);i&&i.length>0&&i.forEach(function(e){var r=n[e];if(r){r(a[e],t)}})}(a)},P=function(e){var r=e.vueObj;return"function"==typeof r.$root._$registerDsEvent&&r.$root._$registerDsEvent(e),!1},C={DatasourceMixin:n,RecordMixin:T,CellMixin:R};r.default={mixins:C}}})});
//# sourceMappingURL=v3-vdk.js.map